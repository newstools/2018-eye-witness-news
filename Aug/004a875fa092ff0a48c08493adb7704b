South Africa were initially set a target of 308 under the Duckworth-Lewis system but further rain interventions left them needing 191 runs from 21 overs. KANDY, Sri Lanka - Suranga Lakmal bowled a tight final over to help Sri Lanka win the rain-hit fourth one-dayer against South Africa by three runs under the Duckworth-Lewis method on Wednesday and snap their losing streak. Having lost the five-match series following three defeats, Sri Lanka batted with conspicuous freedom to post 306-7 after rain had reduced the match to 39 overs-a-side. More rain interruptions left South Africa with a revised target of 191 from 21 overs but Lakmal (3-46) conceded four runs in the final over to seal a thrilling victory in the stop-start game. Put in to bat, Sri Lanka enjoyed their first 50-plus opening partnership of the series from Upul Tharanga (36) and Niroshan Dickwella (34) which laid the foundation for a big total. Kusal Perera smashed 51 but it was the 109-run stand between Thisara Perera (51 not out) and Dasun Shanaka (65) that took Sri Lanka past the 300-mark. Shanaka clobbered five sixes in his 34-ball blitz as Sri Lanka plundered 105 runs from the last 10 overs. South Africa were initially set a target of 308 under the Duckworth-Lewis system but further rain interventions left them needing 191 runs from 21 overs. Hashim Amla made 40 and JP Duminy contributed 38 but South Africa suffered a middle-order collapse that left them needing eight runs from the final over with two wickets in hand. Lakmal dismissed David Miller (21) with the second ball to effectively clinch the match as South Africa finished on 187-9. The tourists will take a 3-1 lead into Sundayâ€™s final one-dayer in Colombo.